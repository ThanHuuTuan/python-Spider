# IO
- [x] txt
- [x] json
- [x] csv
- [x] image

## txt
- 从txt中读取文件
```python
with open('exp.txt')as file_object:
    contents=file_object.read()
    print(contents)
    print(contents.rstrip)
```
- 访问不再绝对路径的文件
```python
 with open('file\\exp.txt')as file_object:
    contents=file_object.read()
    print(contents)
```
- 逐行读取txt文件
```python
filename='file\\exp.txt'
with open(filename)as file_object:
    for content in file_object:
        print(content.rstrip())#使用rstrip()方法实现空白行的删除
```
- 写入空txt文件:不覆盖写入
```python
with open('2016国家工作报告.txt','a',encoding='utf-8')as f:
    f.write(title+'\n')
    f.write(page)
    f.close()
```
## json
- 将数据存储到json文件中
```python
import json
numbers=[2,3,5,7,11,13]
file='numbers.json'
with open(file,'w')as f:
    json.dump(numbers,f)
```
上述的方法即可将数据写入到文件名为'numbers.json'文件中。
- 读取网页上json数据的方法
```python
data = {
            'gender': '2',
            'marry':'1',
            'page':'1'
        }
data['page']=i
url='http://www.lovewzly.com/api/user/pc/list/search?'
resp=requests.get(url,headers=headers,params=data)
if resp.status_code==200:
    data_json=resp.json()['data']['list']
    if len(data_json)>0:
        data_list=[]
        for data in data_json:
            data_list.append((
                data['username'], data['userid'], data['avatar'],
                data['height'], data['education'], data['province'],
                data['city'], data['birthdayyear'], data['gender'], data['monolog']
            ))
```
**data_json=resp.json()['data']['list']** 这个是最关键的语句。另外就是200的提示是成功400-500的提示是失败.
## csv
- 写入
```python
import requests
import xlwt
url_='http://www.htoption.cn/weixin/app/index.php?i=4&c=entry&do=getatmvol&m=ht_otc&mounth=2018-08-27'
url=input("请输入:")
# url_='http://www.htoption.cn/weixin/app/index.php?i=4&c=entry&do=getatmvol&m=ht_otc&mounth='+str(url)
response=requests.get(url_).json()
style0 = xlwt.easyxf('font: name Times New Roman, color-index red, bold on',num_format_str='#,##0.00')
style1 = xlwt.easyxf(num_format_str='D-MMM-YY')
wb = xlwt.Workbook()
ws = wb.add_sheet('A Test Sheet')#当前表的名字
for i in range(0,27):
    ws.write(i,2,response['AskVol'][i])
    ws.write(i,1,response['BidVol'][i])
    ws.write(i,0,response['ContractCode'][i])
    print(response['AskVol'][i])
    print(response['BidVol'][i])
    print(response['ContractCode'][i]+'\n')
wb.save(str(url)+'.xls')
```
- 读取
```python
import xlrd
from datetime import date,datetime
def read_excel():
    #打开文件
    workbook=xlrd.open_workbook(r'郭源潮.xls')
    #获取所有的sheet
    print(workbook.sheet_names())#['A Test Sheet']
    #根据sheet索引或者名称获取sheet内容
    sheet=workbook.sheet_by_index(0)#sheet索引从0开始
    # sheet=workbook.sheet_names('A Test Sheet')
    #sheet的名称，行数，列数
    print(sheet.name,sheet.nrows,sheet.ncols)
    #获取整行和整列的值（数组）
    rows=sheet.row_values(1)#获取第一行的内容
    cols=sheet.col_values(3)#获取第三列的内容
    print(rows[3])#获取第一行的第4个单元格的内容
    print(cols)
if __name__=='__main__':
    read_excel()
```
